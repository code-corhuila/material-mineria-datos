<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Interactivo con Streamlit | Miner√≠a de Datos | Ingenier√≠a de Sistemas</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --primary-color: #1e3c72;
    --secondary-color: #2a5298;
    --accent-color: #ff6b6b;
    --light-bg: #f8f9fa;
    --dark-text: #2c3e50;
    --border-color: #e0e0e0;
    --success-color: #27ae60;
    --warning-color: #f39c12;
    --code-bg: #2d2d2d;
}

body {
    font-family: 'Roboto', sans-serif;
    line-height: 1.6;
    color: var(--dark-text);
    background-color: #fff;
}

/* Header */
.main-header {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    color: white;
    padding: 0;
}

.top-bar {
    background-color: rgba(0, 0, 0, 0.1);
    padding: 20px 0;
    text-align: center;
}

.brand-container {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
}

.logo-img {
    height: 50px;
    width: auto;
    transition: transform 0.3s ease;
}

.logo-img:hover {
    transform: scale(1.05);
}

.brand-name {
    font-size: 18px;
    font-weight: 500;
    letter-spacing: 1px;
}

.main-nav {
    background-color: rgba(0, 0, 0, 0.2);
    padding: 15px 0;
    position: sticky;
    top: 0;
    z-index: 100;
}

.main-nav ul {
    list-style: none;
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 0;
}

.main-nav a {
    color: white;
    text-decoration: none;
    padding: 12px 20px;
    display: block;
    font-size: 14px;
    font-weight: 500;
    transition: background-color 0.3s;
    border-bottom: 3px solid transparent;
}

.main-nav a:hover,
.main-nav a.active {
    background-color: rgba(255, 255, 255, 0.1);
    border-bottom-color: var(--accent-color);
}

/* Container */
.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

/* Main Content */
.main-content {
    padding: 50px 0;
}

section {
    margin-bottom: 40px;
}

h1 {
    color: var(--primary-color);
    font-size: 2.5em;
    margin-bottom: 20px;
    text-align: center;
}

h2 {
    color: var(--secondary-color);
    font-size: 2em;
    margin-bottom: 25px;
    border-left: 5px solid var(--accent-color);
    padding-left: 15px;
}

h3 {
    color: var(--primary-color);
    font-size: 1.5em;
    margin-top: 25px;
    margin-bottom: 15px;
}

h4 {
    color: var(--secondary-color);
    font-size: 1.2em;
    margin-bottom: 10px;
}

/* Hero Section */
.hero-section {
    background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
    color: white;
    padding: 60px 40px;
    border-radius: 10px;
    text-align: center;
}

.hero-section h1 {
    color: white;
    margin-bottom: 20px;
}

.hero-section .lead {
    font-size: 1.2em;
    line-height: 1.8;
}

.lead {
    font-size: 1.1em;
    line-height: 1.8;
    max-width: 900px;
    margin: 0 auto 20px;
}

/* Dividers */
.divider {
    border: none;
    border-top: 2px solid var(--border-color);
    margin: 40px 0;
}

.divider-thick {
    border: none;
    border-top: 3px solid var(--accent-color);
    margin: 50px 0;
}

/* Definition Box */
.definition-box {
    background-color: #e8f4f8;
    border-left: 5px solid var(--secondary-color);
    padding: 20px;
    margin: 20px 0;
    border-radius: 5px;
    font-size: 1.05em;
}

/* Reflection Box */
.reflection-box {
    background-color: #fff3cd;
    border-left: 5px solid var(--warning-color);
    padding: 20px;
    margin: 20px 0;
    border-radius: 5px;
}

.reflection-box h4 {
    color: #856404;
    margin-bottom: 10px;
}

.reflection-box p,
.reflection-box ul {
    color: #856404;
    line-height: 1.7;
}

.reflection-box ul {
    margin-left: 20px;
}

.reflection-box li {
    margin-bottom: 8px;
}

/* Success Box */
.success-box {
    background-color: #d4edda;
    border-left: 5px solid var(--success-color);
    padding: 20px;
    margin: 20px 0;
    border-radius: 5px;
}

.success-box h4 {
    color: #155724;
    margin-bottom: 10px;
}

.success-box p {
    color: #155724;
    line-height: 1.7;
}

/* Cards */
.card {
    background: white;
    border: 1px solid var(--border-color);
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    transition: transform 0.3s, box-shadow 0.3s;
    margin: 15px 0;
}

.card:hover {
    transform: translateY(-5px);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);
}

.card h3,
.card h4 {
    color: var(--secondary-color);
    margin-top: 0;
}

.cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin: 30px 0;
}

/* Code Blocks */
pre {
    background-color: var(--code-bg);
    color: #f8f8f2;
    padding: 20px;
    border-radius: 8px;
    overflow-x: auto;
    margin: 20px 0;
    font-family: 'Fira Code', 'Courier New', monospace;
    font-size: 0.95em;
    line-height: 1.5;
    border-left: 4px solid var(--accent-color);
    position: relative;
}

code {
    font-family: 'Fira Code', 'Courier New', monospace;
    background-color: #f4f4f4;
    padding: 2px 6px;
    border-radius: 3px;
    color: var(--primary-color);
}

pre code {
    background-color: transparent;
    color: #f8f8f2;
    padding: 0;
}

/* Step Box */
.step-box {
    background-color: var(--light-bg);
    border-left: 5px solid var(--secondary-color);
    padding: 25px;
    margin: 20px 0;
    border-radius: 5px;
}

.step-number {
    display: inline-block;
    background-color: var(--secondary-color);
    color: white;
    width: 35px;
    height: 35px;
    border-radius: 50%;
    text-align: center;
    line-height: 35px;
    font-weight: bold;
    margin-right: 15px;
    flex-shrink: 0;
}

.step-box h3 {
    display: flex;
    align-items: center;
    margin-top: 0;
}

.step-box h3 .step-number {
    margin-top: 0;
}

/* Tables */
.table-responsive {
    overflow-x: auto;
    margin: 30px 0;
}

.styled-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.styled-table thead tr {
    background-color: var(--secondary-color);
    color: white;
    text-align: left;
    font-weight: 500;
}

.styled-table th,
.styled-table td {
    padding: 15px;
    border-bottom: 1px solid var(--border-color);
}

.styled-table tbody tr:hover {
    background-color: var(--light-bg);
}

.styled-table tbody tr:nth-child(odd) {
    background-color: #fafafa;
}

/* Lists */
ul, ol {
    margin: 15px 0;
    margin-left: 30px;
}

li {
    margin: 8px 0;
    line-height: 1.7;
}

/* Links */
a {
    color: var(--secondary-color);
    text-decoration: none;
    transition: color 0.3s;
}

a:hover {
    color: var(--accent-color);
    text-decoration: underline;
}

/* Feature List */
.feature-list {
    list-style: none;
    margin: 20px 0;
}

.feature-list li {
    padding: 10px 0;
    border-bottom: 1px solid var(--border-color);
}

.feature-list li:before {
    content: "‚úì ";
    color: var(--success-color);
    font-weight: bold;
    margin-right: 10px;
}

/* Footer */
.main-footer {
    background: var(--primary-color);
    color: white;
    text-align: center;
    padding: 40px 0;
    margin-top: 50px;
}

.main-footer p {
    margin: 8px 0;
    font-size: 0.95em;
}

.main-footer ul {
    list-style: none;
    margin-top: 20px;
}

.main-footer li {
    margin: 8px 0;
}

.main-footer a {
    color: #fff9e6;
    text-decoration: none;
    font-weight: 500;
    transition: color 0.3s;
}

.main-footer a:hover {
    color: var(--accent-color);
}

/* Scroll to Top Button */
#scrollTopBtn {
    display: none;
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: var(--secondary-color);
    color: white;
    border: none;
    padding: 15px 20px;
    font-size: 18px;
    border-radius: 50%;
    cursor: pointer;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    z-index: 99;
    transition: background-color 0.3s;
}

#scrollTopBtn:hover {
    background-color: var(--accent-color);
}

/* Responsive */
@media (max-width: 768px) {
    h1 {
        font-size: 1.8em;
    }
    
    h2 {
        font-size: 1.5em;
    }
    
    .hero-section {
        padding: 40px 20px;
    }
    
    .main-nav ul {
        flex-direction: column;
    }
    
    .main-nav a {
        padding: 10px 15px;
        font-size: 13px;
    }
    
    .cards-grid {
        grid-template-columns: 1fr;
    }
    
    .styled-table {
        font-size: 0.9em;
    }
    
    .styled-table th,
    .styled-table td {
        padding: 10px;
    }
    
    pre {
        font-size: 0.85em;
        padding: 15px;
    }

    .brand-container {
        flex-direction: column;
        gap: 5px;
    }

    .brand-name {
        font-size: 14px;
    }
}
    </style>
</head>
<body>

    <header class="main-header">
        <div class="top-bar">
            <div class="brand-container">
                <img src="https://raw.githubusercontent.com/code-corhuila/material-mineria-datos/b3725d694125ab35294ddfe415a327bc1445d32c/01-week/01-session/LOGO%20CORHUILA%20BLANCO%20PNG%20(2).png" alt="Logo Corhuila" class="logo-img">
                <div>
                    <div class="brand-name">CORHUILA - Corporaci√≥n Universitaria de Huila</div>
                    <div style="font-size: 14px; opacity: 0.9;">Ingenier√≠a de Sistemas | Miner√≠a de Datos</div>
                </div>
            </div>
        </div>
        <nav class="main-nav">
            <ul>
                <li><a href="#introduccion" class="nav-link">Introducci√≥n</a></li>
                <li><a href="#streamlit-setup" class="nav-link">Streamlit Setup</a></li>
                <li><a href="#primer-dashboard" class="nav-link">Primer Dashboard</a></li>
                <li><a href="#integracion-bd" class="nav-link">Integraci√≥n BD</a></li>
                <li><a href="#interactividad" class="nav-link">Interactividad</a></li>
                <li><a href="#despliegue" class="nav-link">Despliegue</a></li>
                <li><a href="#resumen" class="nav-link">Resumen</a></li>
            </ul>
        </nav>
    </header>

    <main class="container main-content">

        <section id="introduccion" class="hero-section">
            <h1>üìä Dashboard Interactivo con Streamlit</h1>
            <p class="lead">Crea dashboards profesionales y visualizaciones interactivas sin necesidad de HTML/CSS/JavaScript</p>
            <p style="margin-top: 20px; font-size: 1em; opacity: 0.95;">
                Transforma tu ETL de clima en una aplicaci√≥n web interactiva que permite exploraci√≥n de datos en tiempo real
            </p>
        </section>

        <hr class="divider">

        <section id="streamlit-setup">
            <h2><i class="fas fa-rocket"></i> Fase 1: Instalaci√≥n de Streamlit</h2>

            <p>Streamlit es un framework Python que convierte scripts de datos en aplicaciones web interactivas con cero conocimiento de JavaScript o CSS.</p>

            <div class="definition-box">
                <h4>¬øQu√© es Streamlit?</h4>
                <p>Streamlit es una librer√≠a de c√≥digo abierto que permite crear dashboards de datos y aplicaciones de ML con Python puro. Es ideal para prototipado r√°pido y demostraci√≥n de proyectos.</p>
            </div>

            <div class="step-box">
                <h3><span class="step-number">1</span>Instala Streamlit</h3>
                <p>En tu proyecto ETL anterior, actualiza <code>requirements.txt</code>:</p>
                <pre><code>requests==2.31.0
pandas==2.1.0
python-dotenv==1.0.0
matplotlib==3.8.0
openpyxl==3.1.2
psycopg2-binary==2.9.9
sqlalchemy==2.0.23
alembic==1.12.1
streamlit==1.28.1
plotly==5.17.0
numpy==1.24.3</code></pre>
                <p style="margin-top: 15px;">Instala las nuevas dependencias:</p>
                <pre><code>pip install -r requirements.txt</code></pre>
            </div>

            <div class="step-box">
                <h3><span class="step-number">2</span>Verifica Instalaci√≥n</h3>
                <p>Verifica que Streamlit est√© instalado correctamente:</p>
                <pre><code>streamlit --version

# Deber√≠as ver algo como:
# Streamlit, version 1.28.1</code></pre>
            </div>

            <div class="reflection-box">
                <h4>‚ö° Ventajas de Streamlit</h4>
                <ul>
                    <li>‚úÖ Escribe Python, no HTML/CSS/JavaScript</li>
                    <li>‚úÖ Recarga en caliente (hot reload)</li>
                    <li>‚úÖ Widgets interactivos integrados</li>
                    <li>‚úÖ Gr√°ficos profesionales (Plotly, Matplotlib)</li>
                    <li>‚úÖ Despliegue simple en Streamlit Cloud</li>
                    <li>‚úÖ Perfecto para MVPs y prototipos</li>
                </ul>
            </div>

            <div class="success-box">
                <h4>‚úÖ Streamlit Instalado</h4>
                <p>Est√°s listo para crear tu primer dashboard interactivo.</p>
            </div>

        </section>

        <hr class="divider">

        <section id="primer-dashboard">
            <h2><i class="fas fa-chart-bar"></i> Fase 2: Primer Dashboard B√°sico</h2>

            <p>Crearemos un dashboard simple que lea datos de PostgreSQL y los visualice.</p>

            <div class="step-box">
                <h3><span class="step-number">1</span>Crea Script Principal</h3>
                <p>Crea <code>dashboard_app.py</code> en la ra√≠z del proyecto:</p>
                <pre><code>#!/usr/bin/env python3
import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
from datetime import datetime, timedelta
import sys
sys.path.insert(0, '.')

from scripts.database import SessionLocal
from scripts.models import Ciudad, RegistroClima, MetricasETL

# Configuraci√≥n de la p√°gina
st.set_page_config(
    page_title="Dashboard de Clima ETL",
    page_icon="üå°Ô∏è",
    layout="wide",
    initial_sidebar_state="expanded"
)

# T√≠tulo principal
st.title("üåç Dashboard de Clima - ETL Weatherstack")
st.markdown("---")

# Conecta a la base de datos
db = SessionLocal()

try:
    # Obt√©n todos los registros de clima
    registros = db.query(RegistroClima, Ciudad.nombre).join(
        Ciudad
    ).order_by(RegistroClima.fecha_extraccion.desc()).all()

    # Transforma en DataFrame
    data = []
    for registro, ciudad_nombre in registros:
        data.append({
            'Ciudad': ciudad_nombre,
            'Temperatura': registro.temperatura,
            'Sensaci√≥n T√©rmica': registro.sensacion_termica,
            'Humedad': registro.humedad,
            'Viento': registro.velocidad_viento,
            'Descripci√≥n': registro.descripcion,
            'Fecha': registro.fecha_extraccion
        })

    df = pd.DataFrame(data)

    # Sidebar con filtros
    st.sidebar.title("üîß Filtros")
    
    ciudades_filtro = st.sidebar.multiselect(
        "Selecciona Ciudades:",
        options=df['Ciudad'].unique(),
        default=df['Ciudad'].unique()
    )
    
    # Filtra datos
    df_filtrado = df[df['Ciudad'].isin(ciudades_filtro)]

    # M√©tricas principales en columnas
    st.subheader("üìà M√©tricas Principales")
    col1, col2, col3, col4 = st.columns(4)

    with col1:
        temp_promedio = df_filtrado['Temperatura'].mean()
        st.metric(
            label="üå°Ô∏è Temp. Promedio",
            value=f"{temp_promedio:.1f}¬∞C",
            delta=f"{temp_promedio - 20:.1f}¬∞C vs esperado"
        )

    with col2:
        humedad_promedio = df_filtrado['Humedad'].mean()
        st.metric(
            label="üíß Humedad Promedio",
            value=f"{humedad_promedio:.1f}%"
        )

    with col3:
        viento_maximo = df_filtrado['Viento'].max()
        ciudad_viento = df_filtrado[df_filtrado['Viento'] == viento_maximo]['Ciudad'].values[0]
        st.metric(
            label="üí® Viento M√°ximo",
            value=f"{viento_maximo:.1f} km/h",
            delta=f"en {ciudad_viento}"
        )

    with col4:
        total_registros = len(df_filtrado)
        st.metric(
            label="üìä Total Registros",
            value=total_registros
        )

    st.markdown("---")

    # Gr√°ficas
    st.subheader("üìâ Visualizaciones")
    
    col1, col2 = st.columns(2)

    # Gr√°fica 1: Temperatura por Ciudad
    with col1:
        fig_temp = px.bar(
            df_filtrado.sort_values('Temperatura', ascending=False),
            x='Ciudad',
            y='Temperatura',
            title="Temperatura Actual por Ciudad",
            color='Temperatura',
            color_continuous_scale='RdYlBu_r'
        )
        st.plotly_chart(fig_temp, use_container_width=True)

    # Gr√°fica 2: Humedad por Ciudad
    with col2:
        fig_humid = px.bar(
            df_filtrado,
            x='Ciudad',
            y='Humedad',
            title="Humedad Relativa por Ciudad",
            color='Humedad',
            color_continuous_scale='Blues'
        )
        st.plotly_chart(fig_humid, use_container_width=True)

    # Gr√°fica 3: Scatter Temperatura vs Humedad
    col1, col2 = st.columns(2)
    
    with col1:
        fig_scatter = px.scatter(
            df_filtrado,
            x='Temperatura',
            y='Humedad',
            size='Viento',
            color='Ciudad',
            title="Temperatura vs Humedad",
            hover_data=['Descripci√≥n']
        )
        st.plotly_chart(fig_scatter, use_container_width=True)

    # Gr√°fica 4: Velocidad del Viento
    with col2:
        fig_wind = px.bar(
            df_filtrado.sort_values('Viento', ascending=False),
            x='Ciudad',
            y='Viento',
            title="Velocidad del Viento",
            color='Viento',
            color_continuous_scale='Viridis'
        )
        st.plotly_chart(fig_wind, use_container_width=True)

    st.markdown("---")

    # Tabla de datos detallada
    st.subheader("üìã Datos Detallados")
    st.dataframe(
        df_filtrado.sort_values('Fecha', ascending=False),
        use_container_width=True,
        height=400
    )

finally:
    db.close()</code></pre>
            </div>

            <div class="step-box">
                <h3><span class="step-number">2</span>Ejecuta el Dashboard</h3>
                <p>Desde la ra√≠z del proyecto:</p>
                <pre><code>streamlit run dashboard_app.py</code></pre>
                <p style="margin-top: 15px;">Streamlit abrir√° autom√°ticamente un navegador en <code>http://localhost:8501</code></p>
            </div>

            <div class="reflection-box">
                <h4>üí° Componentes Principales</h4>
                <p>En el c√≥digo anterior usamos:</p>
                <ul>
                    <li><code>st.title()</code> - T√≠tulo principal</li>
                    <li><code>st.metric()</code> - M√©tricas con valores grandes</li>
                    <li><code>st.columns()</code> - Layouts en columnas</li>
                    <li><code>st.plotly_chart()</code> - Gr√°ficas interactivas</li>
                    <li><code>st.dataframe()</code> - Tablas de datos</li>
                    <li><code>st.sidebar</code> - Panel lateral para controles</li>
                </ul>
            </div>

            <div class="success-box">
                <h4>‚úÖ Dashboard B√°sico Funcionando</h4>
                <p>Tienes un dashboard interactivo mostrando datos de clima desde PostgreSQL.</p>
            </div>

        </section>

        <hr class="divider">

        <section id="integracion-bd">
            <h2><i class="fas fa-database"></i> Fase 3: Integraci√≥n Avanzada con BD</h2>

            <p>Crea un dashboard m√°s robusto con an√°lisis hist√≥ricos y estad√≠sticas avanzadas.</p>

            <div class="step-box">
                <h3><span class="step-number">1</span>Dashboard Mejorado con An√°lisis Hist√≥rico</h3>
                <p>Crea <code>dashboard_advanced.py</code>:</p>
                <pre><code>#!/usr/bin/env python3
import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
from datetime import datetime, timedelta
from sqlalchemy import func
import sys
sys.path.insert(0, '.')

from scripts.database import SessionLocal
from scripts.models import Ciudad, RegistroClima, MetricasETL

st.set_page_config(
    page_title="Dashboard Avanzado clima",
    page_icon="üå°Ô∏è",
    layout="wide"
)

st.title("üåç Dashboard Avanzado - An√°lisis de Clima")
st.markdown("---")

db = SessionLocal()

# Pesta√±as principales
tab1, tab2, tab3, tab4 = st.tabs(["üìä Vista General", "üìà Hist√≥rico", "üîç An√°lisis", "üìã M√©tricas ETL"])

with tab1:
    st.subheader("Datos Actuales")
    
    col1, col2, col3 = st.columns(3)
    
    with col1:
        ciudades_count = db.query(func.count(Ciudad.id)).scalar()
        st.metric("üèôÔ∏è Ciudades", ciudades_count)
    
    with col2:
        registros_count = db.query(func.count(RegistroClima.id)).scalar()
        st.metric("üìä Registros Totales", registros_count)
    
    with col3:
        ultima_fecha = db.query(func.max(RegistroClima.fecha_extraccion)).scalar()
        st.metric("‚è∞ √öltima Actualizaci√≥n", ultima_fecha.strftime("%Y-%m-%d %H:%M"))
    
    st.markdown("---")
    
    # Obt√©n datos actuales
    registros_actuales = db.query(
        Ciudad.nombre,
        RegistroClima.temperatura,
        RegistroClima.humedad,
        RegistroClima.velocidad_viento,
        RegistroClima.descripcion
    ).join(Ciudad).order_by(
        RegistroClima.fecha_extraccion.desc()
    ).distinct(RegistroClima.ciudad_id).all()
    
    df_actual = pd.DataFrame(registros_actuales, columns=[
        'Ciudad', 'Temperatura', 'Humedad', 'Viento', 'Descripci√≥n'
    ])
    
    # Gr√°ficas lado a lado
    col1, col2 = st.columns(2)
    
    with col1:
        fig = px.bar(df_actual, x='Ciudad', y='Temperatura',
                    title='Temperatura Actual', color='Temperatura',
                    color_continuous_scale='RdYlBu_r')
        st.plotly_chart(fig, use_container_width=True)
    
    with col2:
        fig = px.pie(df_actual, values='Humedad', names='Ciudad',
                    title='Distribuci√≥n de Humedad')
        st.plotly_chart(fig, use_container_width=True)
    
    st.markdown("---")
    st.dataframe(df_actual, use_container_width=True)

with tab2:
    st.subheader("An√°lisis Hist√≥rico")
    
    # Rango de fechas
    col1, col2 = st.columns(2)
    
    with col1:
        fecha_inicio = st.date_input("Desde:", value=datetime.now() - timedelta(days=7))
    
    with col2:
        fecha_fin = st.date_input("Hasta:", value=datetime.now())
    
    # Filtra por fechas
    registros_historicos = db.query(
        RegistroClima,
        Ciudad.nombre
    ).join(Ciudad).filter(
        RegistroClima.fecha_extraccion >= fecha_inicio,
        RegistroClima.fecha_extraccion <= fecha_fin
    ).all()
    
    if registros_historicos:
        data = []
        for registro, ciudad_nombre in registros_historicos:
            data.append({
                'Fecha': registro.fecha_extraccion,
                'Ciudad': ciudad_nombre,
                'Temperatura': registro.temperatura,
                'Humedad': registro.humedad,
                'Viento': registro.velocidad_viento
            })
        
        df_historico = pd.DataFrame(data)
        
        # Gr√°fica de temperatura en el tiempo
        fig = px.line(df_historico, x='Fecha', y='Temperatura',
                     color='Ciudad', title='Temperatura en el Tiempo',
                     markers=True)
        st.plotly_chart(fig, use_container_width=True)
        
        st.markdown("---")
        st.dataframe(df_historico, use_container_width=True)
    else:
        st.warning("No hay datos en ese rango de fechas")

with tab3:
    st.subheader("An√°lisis Estad√≠stico")
    
    # Estad√≠sticas por ciudad
    ciudades = db.query(Ciudad).all()
    
    for ciudad in ciudades:
        with st.expander(f"üìç {ciudad.nombre}"):
            registros = db.query(RegistroClima).filter_by(ciudad_id=ciudad.id).all()
            
            if registros:
                temps = [r.temperatura for r in registros]
                humeds = [r.humedad for r in registros]
                vientos = [r.velocidad_viento for r in registros]
                
                col1, col2, col3, col4 = st.columns(4)
                
                with col1:
                    st.metric("üå°Ô∏è Temp Prom.", f"{sum(temps)/len(temps):.1f}¬∞C")
                with col2:
                    st.metric("üíß Humedad Prom.", f"{sum(humeds)/len(humeds):.1f}%")
                with col3:
                    st.metric("üí® Viento Prom.", f"{sum(vientos)/len(vientos):.1f} km/h")
                with col4:
                    st.metric("üìä Registros", len(registros))

with tab4:
    st.subheader("M√©tricas de Ejecuci√≥n ETL")
    
    metricas = db.query(MetricasETL).order_by(
        MetricasETL.fecha_ejecucion.desc()
    ).limit(20).all()
    
    if metricas:
        data = []
        for m in metricas:
            data.append({
                'Fecha': m.fecha_ejecucion,
                'Estado': m.estado,
                'Extra√≠dos': m.registros_extraidos,
                'Guardados': m.registros_guardados,
                'Fallidos': m.registros_fallidos,
                'Tiempo (s)': f"{m.tiempo_ejecucion_segundos:.2f}"
            })
        
        df_metricas = pd.DataFrame(data)
        st.dataframe(df_metricas, use_container_width=True)
        
        # Gr√°ficas de m√©tricas
        col1, col2 = st.columns(2)
        
        with col1:
            fig = px.bar(df_metricas, x='Fecha', y='Guardados',
                        title='Registros Guardados por Ejecuci√≥n',
                        color='Estado')
            st.plotly_chart(fig, use_container_width=True)
        
        with col2:
            fig = px.scatter(df_metricas, x='Fecha', y='Tiempo (s)',
                           size='Guardados', title='Duraci√≥n de Ejecuciones',
                           color='Estado')
            st.plotly_chart(fig, use_container_width=True)
    else:
        st.info("No hay m√©tricas registradas a√∫n")

db.close()</code></pre>
            </div>

            <div class="step-box">
                <h3><span class="step-number">2</span>Ejecuta Dashboard Avanzado</h3>
                <pre><code>streamlit run dashboard_advanced.py</code></pre>
            </div>

            <div class="success-box">
                <h4>‚úÖ Dashboard Avanzado Completado</h4>
                <p>Ahora tienes un dashboard profesional con m√∫ltiples vistas y an√°lisis profundos.</p>
            </div>

        </section>

        <hr class="divider">

        <section id="interactividad">
            <h2><i class="fas fa-mouse"></i> Fase 4: Agregar Interactividad</h2>

            <p>Crea un dashboard completamente interactivo con formularios y b√∫squedas avanzadas.</p>

            <div class="step-box">
                <h3><span class="step-number">1</span>Dashboard Interactivo Completo</h3>
                <p>Crea <code>dashboard_interactive.py</code>:</p>
                <pre><code>#!/usr/bin/env python3
import streamlit as st
import pandas as pd
import plotly.express as px
import plotly.graph_objects as go
from datetime import datetime, timedelta
from sqlalchemy import func, and_
import sys
sys.path.insert(0, '.')

from scripts.database import SessionLocal
from scripts.models import Ciudad, RegistroClima

st.set_page_config(
    page_title="Dashboard Interactivo",
    page_icon="üéõÔ∏è",
    layout="wide"
)

# CSS personalizado
st.markdown("""
    <style>
    .metric-box {
        background-color: #f0f2f6;
        padding: 20px;
        border-radius: 10px;
        margin: 10px 0;
    }
    </style>
""", unsafe_allow_html=True)

st.title("üéõÔ∏è Dashboard Interactivo - Control Total")

db = SessionLocal()

# Sidebar con controles
st.sidebar.markdown("### üîß Controles")

# Selector de ciudades
ciudades_disponibles = [c.nombre for c in db.query(Ciudad).all()]
ciudades_seleccionadas = st.sidebar.multiselect(
    "üèôÔ∏è Ciudades a Mostrar",
    options=ciudades_disponibles,
    default=ciudades_disponibles[:2]
)

# Rango de fechas
col1, col2 = st.sidebar.columns(2)
with col1:
    fecha_inicio = st.sidebar.date_input(
        "üìÖ Desde:",
        value=datetime.now() - timedelta(days=30)
    )
with col2:
    fecha_fin = st.sidebar.date_input(
        "üìÖ Hasta:",
        value=datetime.now()
    )

# Filtros de temperatura
col1, col2 = st.sidebar.columns(2)
with col1:
    temp_min = st.sidebar.slider("üå°Ô∏è Temp M√≠n (¬∞C):", -50, 50, value=-10)
with col2:
    temp_max = st.sidebar.slider("üå°Ô∏è Temp M√°x (¬∞C):", -50, 50, value=40)

# Obt√©n datos filtrados
registros_filtrados = db.query(
    RegistroClima,
    Ciudad.nombre,
    Ciudad.pais
).join(Ciudad).filter(
    and_(
        Ciudad.nombre.in_(ciudades_seleccionadas),
        RegistroClima.fecha_extraccion >= fecha_inicio,
        RegistroClima.fecha_extraccion <= fecha_fin,
        RegistroClima.temperatura >= temp_min,
        RegistroClima.temperatura <= temp_max
    )
).all()

# Construye DataFrame
data = []
for registro, ciudad_nombre, pais in registros_filtrados:
    data.append({
        'Ciudad': ciudad_nombre,
        'Pa√≠s': pais,
        'Temperatura': registro.temperatura,
        'Sensaci√≥n': registro.sensacion_termica,
        'Humedad': registro.humedad,
        'Viento': registro.velocidad_viento,
        'Descripci√≥n': registro.descripcion,
        'Fecha': registro.fecha_extraccion
    })

df = pd.DataFrame(data) if data else pd.DataFrame()

if not df.empty:
    # KPIs
    st.markdown("### üìä Indicadores Clave")
    
    col1, col2, col3, col4, col5 = st.columns(5)
    
    with col1:
        st.metric(
            "üå°Ô∏è Temp Max",
            f"{df['Temperatura'].max():.1f}¬∞C"
        )
    
    with col2:
        st.metric(
            "üå°Ô∏è Temp Min",
            f"{df['Temperatura'].min():.1f}¬∞C"
        )
    
    with col3:
        st.metric(
            "üå°Ô∏è Temp Prom",
            f"{df['Temperatura'].mean():.1f}¬∞C"
        )
    
    with col4:
        st.metric(
            "üíß Humedad Prom",
            f"{df['Humedad'].mean():.1f}%"
        )
    
    with col5:
        st.metric(
            "üí® Viento Max",
            f"{df['Viento'].max():.1f} km/h"
        )
    
    st.markdown("---")
    
    # Gr√°ficas interactivas
    col1, col2 = st.columns(2)
    
    with col1:
        st.markdown("#### Comparativa de Temperaturas")
        fig = px.box(
            df,
            x='Ciudad',
            y='Temperatura',
            color='Ciudad',
            title='Distribuci√≥n de Temperaturas por Ciudad'
        )
        st.plotly_chart(fig, use_container_width=True)
    
    with col2:
        st.markdown("#### Promedio de Humedad")
        humedad_ciudad = df.groupby('Ciudad')['Humedad'].mean().reset_index()
        fig = px.bar(
            humedad_ciudad,
            x='Ciudad',
            y='Humedad',
            color='Humedad',
            color_continuous_scale='Blues'
        )
        st.plotly_chart(fig, use_container_width=True)
    
    st.markdown("---")
    
    # L√≠nea temporal
    st.markdown("#### üìà Evoluci√≥n Temporal")
    
    df['Fecha'] = pd.to_datetime(df['Fecha'])
    temp_tiempo = df.groupby(['Fecha', 'Ciudad'])['Temperatura'].mean().reset_index()
    
    fig = px.line(
        temp_tiempo,
        x='Fecha',
        y='Temperatura',
        color='Ciudad',
        title='Temperatura en el Tiempo',
        markers=True
    )
    st.plotly_chart(fig, use_container_width=True)
    
    st.markdown("---")
    
    # Tabla interactiva
    st.markdown("#### üìã Datos Detallados")
    
    # Opciones de visualizaci√≥n
    col1, col2 = st.columns(2)
    
    with col1:
        mostrar_todos = st.checkbox("Mostrar todos los registros", value=False)
    
    with col2:
        columnas_mostrar = st.multiselect(
            "Columnas a mostrar:",
            df.columns.tolist(),
            default=['Ciudad', 'Temperatura', 'Humedad', 'Descripci√≥n', 'Fecha']
        )
    
    if mostrar_todos:
        st.dataframe(df[columnas_mostrar], use_container_width=True, height=600)
    else:
        st.dataframe(df[columnas_mostrar].head(20), use_container_width=True)
    
    # Descargar datos
    st.markdown("---")
    csv = df.to_csv(index=False)
    st.download_button(
        label="‚¨áÔ∏è Descargar datos como CSV",
        data=csv,
        file_name=f"clima_datos_{datetime.now().strftime('%Y%m%d_%H%M%S')}.csv",
        mime="text/csv"
    )

else:
    st.warning("‚ö†Ô∏è No hay datos que coincidan con los filtros seleccionados")

db.close()</code></pre>
            </div>

            <div class="reflection-box">
                <h4>üé® Widgets Interactivos Usados</h4>
                <ul>
                    <li><code>st.multiselect()</code> - Selector m√∫ltiple</li>
                    <li><code>st.date_input()</code> - Selector de fechas</li>
                    <li><code>st.slider()</code> - Control deslizante</li>
                    <li><code>st.checkbox()</code> - Casilla de verificaci√≥n</li>
                    <li><code>st.download_button()</code> - Bot√≥n de descarga</li>
                    <li><code>st.columns()</code> - Layouts responsivos</li>
                </ul>
            </div>

            <div class="success-box">
                <h4>‚úÖ Dashboard Completamente Interactivo</h4>
                <p>Los usuarios pueden filtrar, personalizar y descargar datos sin escribir c√≥digo.</p>
            </div>

        </section>

        <hr class="divider">

        <section id="despliegue">
            <h2><i class="fas fa-cloud"></i> Fase 5: Despliegue en Streamlit Cloud</h2>

            <p>Publica tu dashboard en l√≠nea para que otros lo usen en tiempo real.</p>

            <div class="step-box">
                <h3><span class="step-number">1</span>Prepara el Repositorio</h3>
                <p>Primero, sube tu c√≥digo a GitHub:</p>
                <pre><code>git add .
git commit -m "feat: Agregar dashboards Streamlit"
git push origin main</code></pre>
            </div>

            <div class="step-box">
                <h3><span class="step-number">2</span>Crea Cuenta en Streamlit Cloud</h3>
                <p>Ve a <a href="https://streamlit.io/cloud" target="_blank">streamlit.io/cloud</a></p>
                <ul>
                    <li>Haz clic en "Sign up"</li>
                    <li>Autent√≠cate con tu cuenta de GitHub</li>
                    <li>Autoriza Streamlit para acceder a tus repositorios</li>
                </ul>
            </div>

            <div class="step-box">
                <h3><span class="step-number">3</span>Crea un archivo requirements.txt</h3>
                <p>Aseg√∫rate de que tu <code>requirements.txt</code> est√© actualizado:</p>
                <pre><code>requests==2.31.0
pandas==2.1.0
python-dotenv==1.0.0
matplotlib==3.8.0
openpyxl==3.1.2
psycopg2-binary==2.9.9
sqlalchemy==2.0.23
alembic==1.12.1
streamlit==1.28.1
plotly==5.17.0
numpy==1.24.3</code></pre>
            </div>

            <div class="step-box">
                <h3><span class="step-number">4</span>Crea archivo .streamlit/secrets.toml</h3>
                <p>Para las credenciales de BD, crea la carpeta <code>.streamlit/</code> en la ra√≠z:</p>
                <pre><code>mkdir .streamlit

# Crea archivo secrets.toml
echo "DB_HOST = 'your_host'" > .streamlit/secrets.toml
echo "DB_PORT = '5432'" >> .streamlit/secrets.toml
echo "DB_USER = 'postgres'" >> .streamlit/secrets.toml
echo "DB_PASSWORD = 'your_password'" >> .streamlit/secrets.toml
echo "DB_NAME = 'weatherstack_etl'" >> .streamlit/secrets.toml</code></pre>
                <p style="margin-top: 15px;"><strong>‚ö†Ô∏è Importante:</strong> Agrega <code>.streamlit/secrets.toml</code> a <code>.gitignore</code></p>
            </div>

            <div class="step-box">
                <h3><span class="step-number">5</span>Deploy en Streamlit Cloud</h3>
                <p>En el dashboard de Streamlit Cloud:</p>
                <ul>
                    <li>Haz clic en "New app"</li>
                    <li>Selecciona tu repositorio GitHub</li>
                    <li>Selecciona la rama: <code>main</code></li>
                    <li>Especifica el archivo: <code>dashboard_interactive.py</code></li>
                    <li>Haz clic en "Deploy"</li>
                </ul>
            </div>

            <div class="step-box">
                <h3><span class="step-number">6</span>Configura Secrets en Streamlit Cloud</h3>
                <p>En el men√∫ de configuraci√≥n de tu app:</p>
                <ul>
                    <li>Ve a "Advanced settings"</li>
                    <li>Busca "Secrets"</li>
                    <li>Pega el contenido de <code>.streamlit/secrets.toml</code></li>
                    <li>Guarda cambios</li>
                </ul>
            </div>

            <div class="reflection-box">
                <h4>üîê Variables de Entorno en Streamlit Cloud</h4>
                <p>Para acceder a las variables en tu c√≥digo:</p>
                <pre><code>DB_HOST = st.secrets["DB_HOST"]
DB_PORT = st.secrets["DB_PORT"]
DB_USER = st.secrets["DB_USER"]
DB_PASSWORD = st.secrets["DB_PASSWORD"]
DB_NAME = st.secrets["DB_NAME"]</code></pre>
            </div>

            <div class="success-box">
                <h4>‚úÖ Dashboard en L√≠nea</h4>
                <p>Tu dashboard estar√° disponible en una URL p√∫blica (ej: https://yourapp-streamlit.app)</p>
            </div>

        </section>

        <hr class="divider">

        <section id="resumen">
            <h2><i class="fas fa-check-circle"></i> Resumen: De Datos a Dashboard</h2>

            <div class="cards-grid">
                <div class="card">
                    <h3>üìö Fase 1: Setup</h3>
                    <p><strong>10 minutos</strong></p>
                    <ul style="margin-left: 0; list-style: none;">
                        <li>‚úÖ Instalar Streamlit</li>
                        <li>‚úÖ Verificar instalaci√≥n</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>üìä Fase 2: Dashboard B√°sico</h3>
                    <p><strong>30 minutos</strong></p>
                    <ul style="margin-left: 0; list-style: none;">
                        <li>‚úÖ Script principal</li>
                        <li>‚úÖ M√©tricas y gr√°ficas</li>
                        <li>‚úÖ Filtros en sidebar</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>üóÑÔ∏è Fase 3: Integraci√≥n BD</h3>
                    <p><strong>30 minutos</strong></p>
                    <ul style="margin-left: 0; list-style: none;">
                        <li>‚úÖ An√°lisis hist√≥rico</li>
                        <li>‚úÖ M√∫ltiples pesta√±as</li>
                        <li>‚úÖ Estad√≠sticas avanzadas</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>üéõÔ∏è Fase 4: Interactividad</h3>
                    <p><strong>30 minutos</strong></p>
                    <ul style="margin-left: 0; list-style: none;">
                        <li>‚úÖ Widgets avanzados</li>
                        <li>‚úÖ Filtros personalizados</li>
                        <li>‚úÖ Descargas de datos</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>‚òÅÔ∏è Fase 5: Despliegue</h3>
                    <p><strong>20 minutos</strong></p>
                    <ul style="margin-left: 0; list-style: none;">
                        <li>‚úÖ GitHub integration</li>
                        <li>‚úÖ Streamlit Cloud</li>
                        <li>‚úÖ Secrets management</li>
                    </ul>
                </div>

                <div class="card">
                    <h3>üöÄ Resultado Final</h3>
                    <p><strong>ETL Completo + Dashboard</strong></p>
                    <ul style="margin-left: 0; list-style: none;">
                        <li>‚úÖ Extracci√≥n desde API</li>
                        <li>‚úÖ Storage en PostgreSQL</li>
                        <li>‚úÖ Visualizaci√≥n interactiva</li>
                    </ul>
                </div>
            </div>

            <h3>‚è±Ô∏è Tiempo Total: 2-3 horas</h3>

            <div class="reflection-box">
                <h4>üéØ Comparativa: Herramientas de Dashboards</h4>
                <div class="table-responsive">
                    <table class="styled-table">
                        <thead>
                            <tr>
                                <th>Criterio</th>
                                <th>Streamlit</th>
                                <th>Dash (Plotly)</th>
                                <th>Tableau</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Lenguaje</strong></td>
                                <td>Python</td>
                                <td>Python</td>
                                <td>Propietario</td>
                            </tr>
                            <tr>
                                <td><strong>Curva aprendizaje</strong></td>
                                <td>Muy baja</td>
                                <td>Media</td>
                                <td>Media-Alta</td>
                            </tr>
                            <tr>
                                <td><strong>Interactividad</strong></td>
                                <td>Buena</td>
                                <td>Excelente</td>
                                <td>Excelente</td>
                            </tr>
                            <tr>
                                <td><strong>Despliegue</strong></td>
                                <td>F√°cil (Cloud)</td>
                                <td>Medio (Heroku, etc)</td>
                                <td>Dif√≠cil (Licencia)</td>
                            </tr>
                            <tr>
                                <td><strong>Costo</strong></td>
                                <td>Gratis/Bajo</td>
                                <td>Gratis/Bajo</td>
                                <td>Alto ($)</td>
                            </tr>
                            <tr>
                                <td><strong>Para prototipos</strong></td>
                                <td>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                                <td>‚≠ê‚≠ê‚≠ê‚≠ê</td>
                                <td>‚≠ê‚≠ê‚≠ê</td>
                            </tr>
                            <tr>
                                <td><strong>Para producci√≥n</strong></td>
                                <td>‚≠ê‚≠ê‚≠ê‚≠ê</td>
                                <td>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                                <td>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <hr class="divider">

            <h3>üöÄ Pr√≥ximos Pasos</h3>

            <div class="cards-grid">
                <div class="card">
                    <h3>üì± Apps M√≥viles</h3>
                    <p>Usar Flutter o React Native para llevar tu dashboard al m√≥vil</p>
                </div>

                <div class="card">
                    <h3>ü§ñ Machine Learning</h3>
                    <p>Agregar predicciones de clima usando modelos de ML</p>
                </div>

                <div class="card">
                    <h3>‚öôÔ∏è Automatizaci√≥n</h3>
                    <p>Scheduler autom√°tico del ETL cada hora/d√≠a</p>
                </div>

                <div class="card">
                    <h3>üìß Alertas</h3>
                    <p>Notificaciones por email si temperatura sube/baja de umbrales</p>
                </div>
            </div>

            <div class="success-box">
                <h4>‚ú® ¬°PROYECTO FINAL COMPLETADO!</h4>
                <p>Has creado un sistema profesional de:</p>
                <ul>
                    <li>üîÑ <strong>Extracci√≥n:</strong> API Weatherstack</li>
                    <li>üíæ <strong>Almacenamiento:</strong> PostgreSQL</li>
                    <li>üìä <strong>Visualizaci√≥n:</strong> Streamlit Dashboard</li>
                    <li>‚òÅÔ∏è <strong>Despliegue:</strong> Streamlit Cloud (Online)</li>
                </ul>
                <p style="margin-top: 20px;">Este es un proyecto real que empresas usan hoy en producci√≥n. ¬°Felicidades! üéâ</p>
            </div>

        </section>

        <hr class="divider-thick">

        <section style="background: linear-gradient(135deg, #f8f9fa 0%, #e8f4f8 100%); padding: 40px; border-radius: 10px; margin: 30px 0;">
            <h2 style="border-left: 5px solid var(--success-color); color: var(--primary-color);">üìö Archivos Creados en Fase 4</h2>
            
            <pre style="background: #000000; color: #ffffff; border: 2px solid var(--secondary-color);"><code>etl-weatherstack/
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ database.py
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ extractor.py
‚îÇ   ‚îú‚îÄ‚îÄ extractor_db.py
‚îÇ   ‚îú‚îÄ‚îÄ consultas.py
‚îÇ   ‚îî‚îÄ‚îÄ test_db.py
‚îú‚îÄ‚îÄ dashboard_app.py                # ‚≠ê Dashboard b√°sico
‚îú‚îÄ‚îÄ dashboard_advanced.py            # ‚≠ê Dashboard con an√°lisis
‚îú‚îÄ‚îÄ dashboard_interactive.py         # ‚≠ê Dashboard interactivo completo
‚îú‚îÄ‚îÄ .streamlit/
‚îÇ   ‚îú‚îÄ‚îÄ secrets.toml                # ‚≠ê Credenciales (NO commitear)
‚îÇ   ‚îî‚îÄ‚îÄ config.toml                 # ‚≠ê Configuraci√≥n Streamlit
‚îú‚îÄ‚îÄ requirements.txt                # ‚≠ê Actualizado
‚îú‚îÄ‚îÄ .gitignore                      # ‚≠ê Incluye .streamlit/secrets.toml
‚îî‚îÄ‚îÄ README.md
</code></pre>
        </section>

    </main>

    <footer class="main-footer">
        <div class="container">
            <p><strong>Corporaci√≥n Universitaria de Huila (CORHUILA)</strong></p>
            <p>Ingenier√≠a de Sistemas | Miner√≠a de Datos 2026</p>
            <p style="margin-top: 20px; font-size: 0.9em; opacity: 0.9;">
                Material Educativo - Uso Acad√©mico Autorizado | 
                <a href="https://www.corhuila.edu.co" target="_blank">www.corhuila.edu.co</a>
            </p>
            <p style="margin-top: 15px; font-size: 0.9em; opacity: 0.95;">
                üìö Desarrollado por: <strong>Ing. Julian Quimbayo Castro</strong>
            </p>
            <p style="margin-top: 20px; font-size: 0.85em;">
                ¬© 2026 Todos los derechos reservados
            </p>
        </div>
    </footer>

    <button id="scrollTopBtn" title="Volver arriba">‚Üë</button>

    <script>
document.addEventListener('DOMContentLoaded', function() {
    setupScrollButton();
    setupNavigation();
    setupSmoothScroll();
    highlightActiveSection();
});

function setupScrollButton() {
    const scrollBtn = document.getElementById('scrollTopBtn');

    window.addEventListener('scroll', function() {
        if (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) {
            scrollBtn.style.display = 'block';
        } else {
            scrollBtn.style.display = 'none';
        }
    });

    scrollBtn.addEventListener('click', function() {
        window.scrollTo({top: 0, behavior: 'smooth'});
    });
}

function setupSmoothScroll() {
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({behavior: 'smooth'});
            }
        });
    });
}

function setupNavigation() {
    const navLinks = document.querySelectorAll('.main-nav a');
    window.addEventListener('scroll', highlightActiveSection);
}

function highlightActiveSection() {
    const navLinks = document.querySelectorAll('.main-nav a');
    let current = '';

    const sections = document.querySelectorAll('section');
    sections.forEach(section => {
        const sectionTop = section.offsetTop;
        if (pageYOffset >= sectionTop - 200) {
            current = section.getAttribute('id');
        }
    });

    navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href').slice(1) === current) {
            link.classList.add('active');
        }
    });
}

document.querySelectorAll('pre').forEach(pre => {
    const button = document.createElement('button');
    button.textContent = 'üìã Copiar';
    button.style.cssText = `
        position: absolute;
        top: 10px;
        right: 10px;
        background-color: #2a5298;
        color: white;
        border: none;
        padding: 8px 12px;
        border-radius: 5px;
        cursor: pointer;
        font-size: 13px;
        opacity: 0;
        transition: opacity 0.3s;
    `;

    pre.style.position = 'relative';
    pre.appendChild(button);

    pre.addEventListener('mouseenter', () => {
        button.style.opacity = '1';
    });

    pre.addEventListener('mouseleave', () => {
        button.style.opacity = '0';
    });

    button.addEventListener('click', () => {
        const text = pre.querySelector('code').textContent;
        navigator.clipboard.writeText(text).then(() => {
            button.textContent = '‚úÖ Copiado!';
            setTimeout(() => {
                button.textContent = 'üìã Copiar';
            }, 2000);
        });
    });
});
    </script>
</body>
</html>